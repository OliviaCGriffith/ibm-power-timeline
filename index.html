<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>IBM Power Timeline</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Tailwind Custom Configuration -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          borderRadius: {
            '2xl': '1rem'
          },
          boxShadow: {
            xl: '0 10px 25px rgba(0,0,0,0.15)'
          },
          colors: {
            ibmBlue: '#1f4c79',
            ibmIndigo: '#4f46e5'
          },
          gradientColorStops: {
            yellow: '#facc15',
            red: '#f87171',
            purple: '#c084fc',
            blue: '#1e3a8a',
          }
        }
      }
    }
  </script>

  <style>
    body { background: #f5f7fa; }

    .circle {
      width: 90px;
      height: 90px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: bold;
      color: white;
      text-align: center;
      box-shadow: 0 8px 18px rgba(0,0,0,0.15);
    }

    .timeline-bar {
      height: 12px;
      background: linear-gradient(to right, #facc15, #fb923c, #c084fc, #1e3a8a);
      border-radius: 6px;
      margin-top: 40px;
      margin-bottom: 40px;
      position: relative;
    }

    .timeline-dot {
      width: 26px;
      height: 26px;
      border-radius: 50%;
      background: white;
      border: 4px solid #1e3a8a;
      position: absolute;
      top: -7px;
      transform: translateX(-50%);
    }
  </style>
</head>

<body class="p-6">

<div id="app" class="max-w-5xl mx-auto bg-white shadow-2xl rounded-2xl p-8"></div>

<script>
/* ---------------------------------------------------
   FINAL FULL IBM POWER TIMELINE (React-free version)
-----------------------------------------------------*/

let step = 1;

let form = {
  poDate: "",
  s1022: 0,
  s1024: 0,
  e1050: 0,
  e1080: 0,
  labHours: 0,
  lpars: 0
};

let timeline = null;

function addDays(date, days) {
  const d = new Date(date);
  d.setDate(d.getDate() + days);
  return d;
}

function addWeeks(date, weeks) {
  return addDays(date, weeks * 7);
}

function calcWeeks(n) {
  n = Number(n);
  if (n === 0) return 0;
  if (n <= 10) return 1;
  return 3;
}

function generateTimeline() {
  if (!form.poDate) return;

  const po = new Date(form.poDate);
  const buildShip = addDays(po, 21);

  let install = new Date(buildShip);
  install = addWeeks(install, calcWeeks(form.s1022));
  install = addWeeks(install, calcWeeks(form.s1024));
  install = addWeeks(install, calcWeeks(form.e1050));
  install = addWeeks(install, calcWeeks(form.e1080));

  let eos = addDays(install, 61);

  if (form.labHours > 1000) {
    const extra = Math.floor((form.labHours - 1000) / 100);
    eos = addDays(eos, extra * 10);
  }

  if (form.lpars > 130) {
    const extra = Math.floor((form.lpars - 130) / 10);
    eos = addDays(eos, extra * 5);
  }

  timeline = { po, buildShip, install, eos };
}

function fmt(d) {
  return d.toLocaleDateString();
}

function render() {
  const app = document.getElementById("app");

  /* -------------------------------
     PAGE 1 — INPUT USER DATA
  --------------------------------*/
  if (step === 1) {
    app.innerHTML = `
      <h1 class="text-3xl font-bold mb-6">IBM Power — Timeline</h1>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

        <div>
          <label class="block text-sm font-medium text-gray-700">PO Received Date</label>
          <input type="date" id="poDate" class="mt-2 w-full p-3 border rounded-lg" value="${form.poDate}">
        </div>

        ${[
          ["s1022", "# S1022/1122"],
          ["s1024", "# S1024/1124"],
          ["e1050", "# E1050/1150"],
          ["e1080", "# E1080/1180"],
          ["labHours", "Expert Lab Hours"],
          ["lpars", "LPAR Count"]
        ]
        .map(([key, label]) => `
          <div class="p-4 border rounded-2xl bg-gray-50 shadow">
            <div class="flex justify-between mb-2">
              <label class="font-medium">${label}</label>
              <span class="font-bold text-indigo-600">${form[key]}</span>
            </div>
            <input
              type="range"
              min="0"
              max="50"
              step="1"
              id="${key}"
              value="${form[key]}"
              class="w-full"
            >
          </div>
        `).join("")}

      </div>

      <div class="flex justify-end mt-8">
        <button onclick="goNext()" class="px-6 py-2 bg-indigo-600 text-white rounded-md shadow">
          Generate Timeline
        </button>
      </div>
    `;
  }

  /* -------------------------------
     PAGE 2 — TIMELINE RESULT
  --------------------------------*/
  if (step === 2) {
    app.innerHTML = `
      <h1 class="text-3xl font-bold mb-6">Timeline Result</h1>

      <div class="timeline-bar">
        <div class="timeline-dot" style="left: 0%"></div>
        <div class="timeline-dot" style="left: 33%"></div>
        <div class="timeline-dot" style="left: 66%"></div>
        <div class="timeline-dot" style="left: 100%"></div>
      </div>

      <div class="grid grid-cols-4 text-center gap-6">
        ${[
          ["PO Received", fmt(timeline.po), "bg-yellow-400"],
          ["Build/Ship", fmt(timeline.buildShip), "bg-orange-500"],
          ["Installation", fmt(timeline.install), "bg-purple-500"],
          ["End of Service", fmt(timeline.eos), "bg-blue-800"]
        ]
        .map(([label, date, color]) => `
          <div>
            <div class="circle ${color} mx-auto">${date}</div>
            <p class="mt-3 font-semibold">${label}</p>
          </div>
        `).join("")}
      </div>

      <div class="flex justify-between mt-10">
        <button onclick="goBack()" class="px-6 py-2 border rounded-md">Back</button>
        <button onclick="resetApp()" class="px-6 py-2 border rounded-md">Start Over</button>
      </div>
    `;
  }

  /* Re-attach event listeners */
  document.querySelectorAll("input").forEach((el) => {
    el.addEventListener("input", (e) => {
      form[e.target.id] = e.target.value;
      render();
    });
  });
}

function goNext() {
  generateTimeline();
  step = 2;
  render();
}

function goBack() {
  step = 1;
  render();
}

function resetApp() {
  form = {
    poDate: "",
    s1022: 0,
    s1024: 0,
    e1050: 0,
    e1080: 0,
    labHours: 0,
    lpars: 0
  };
  step = 1;
  render();
}

render();
</script>

</body>
</html>
